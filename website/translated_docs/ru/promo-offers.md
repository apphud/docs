Промо-предложения – это скидки или дополнительный бесплатный пробный период для текущих или бывших подписчиков. Они доступны начиная с iOS 12.2. В отличие от вводных предложений, промо-предложения могут применяться неограниченное количество раз, но требуют создания подписи на вашем сервере для оформления покупки. Apphud сделает работу за вас.

## Настройка промо-предложений в App Store Connect

Чтобы создать новое промо-предложение, перейдите в <a href="https://appstoreconnect.apple.com/" target="_blank">App Store Connect</a> и откройте страницу с вашей подпиской. Нажмите *"+"* в разделе цен на подписку и выберите *"Создать промо-предложение"*.

![](assets/promo-offers-1.png)

Укажите оригинальное название промо-предложения и его идентификатор – Product Code.

![](assets/promo-offers-2.png)

Укажите стоимость и тип промо-предложения:

* оплата по факту использования;
* предоплата;
* бесплатный период.

Сохраните изменения.

## Ключ подписки

Для использования промо-предложений нужно сгенерировать подпись. Apphud сделает все за вас, вам остается только создать Ключ подписки и загрузить его в Apphud.

Перейдите в раздел *"Пользователи и Доступ"*, далее во вкладку *"Ключи"*. Создайте новый Ключ подписки, указав его имя.

![](assets/promo-offers-3.png)

После создания ключа нажмите *"Загрузить ключ API"* и сохраните файл в безопасном месте. Он будет использован для загрузки в Apphud. 

> Ключ подписки имеет следующий формат названия: SubscriptionKey_[KEY_ID].p8, где KEY_ID – идентификатор ключа. **Пожалуйста, не перeименовывайте файл**.



![](assets/promo-offers-4.png)

## Загрузка ключа подписки в Apphud

В <a href="https://app.apphud.com/" target="_blank">Apphud</a> откройте настройки приложения. Перейдите на вкладку *"Products"*. Загрузите файл ключа подписки.

![](assets/promo-offers-5.png)

## Использование промо-предложений

Вы сами решаете, когда показать промо-предложение пользователю. Промо-предложения появятся в массиве `discounts` вашего объекта `SKProduct`.

Проверьте, может ли пользователь воспользоваться промо-предложением, вызвав метод:

```swift
// Checking eligibility for promotional offer
Apphud.checkEligibilityForPromotionalOffer(product: myProduct) { result in
  if result {
    // User is eligible to purchase promotional offer
  }
}
```

Для оформления покупки вызовите следующий метод:

```swift
// inside your purchase method, where discountID is identifier of SKProductDiscount object
Apphud.purchasePromo(product: product, discountID: discountID, callback: { (subsc, error) in
	// handle result
})
```

Apphud SDK автоматически отправит чек пользователя в Apphud, так что вам не нужно вызывать метод `submitPurchase`.